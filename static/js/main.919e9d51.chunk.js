(this.webpackJsonpchallenge=this.webpackJsonpchallenge||[]).push([[0],{23:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var r,a,c,o,s,i,u,l,h,p,b,d,j,m,f,g,O,x,v,C=n(7),y=n.n(C),w=(n(23),n(3)),S=n(0),N=n(5),U="PUBLIC",k="GROUPS",E="PRIVATE",I="USERS",G="SEND_MESSAGE",T="UPDATE_CHAT",R="CHANGE_CHAT",A="CREATE_NEW_GROUP",J="START_PRIVATE_CHAT",M="ADD_USER",P="REMOVE_USER",z="CHANGE_USERNAME",L=n(4),_=n(11),D=N.c,B=n(1),H=L.a.input(r||(r=Object(w.a)(["\n  border: 2px solid black;\n  border-radius: 5px;\n  margin: 5px 0 10px;\n  padding: 5px 10px;\n  display: block;\n"]))),V=function(e){var t=e.placeholder,n=e.onUserInput,r=Object(S.useRef)(null);return Object(B.jsx)(H,{type:"text",ref:r,onChange:function(){n(r.current.value)},placeholder:t})},W=L.a.div(a||(a=Object(w.a)(["\n  background-color: rgba(0, 0, 0, 0.555);\n  width: 100vw;\n  height: 100vh;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 10;\n"]))),F=L.a.div(c||(c=Object(w.a)(["\n  background-color: white;\n  border-radius: 20px;\n  padding: 10px 20px;\n  position: fixed;\n  top: 45%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 11;\n"]))),q=function(e){var t=e.children,n=e.onClose;return Object(B.jsxs)(S.Fragment,{children:[Object(C.createPortal)(Object(B.jsx)(W,{onClick:n}),document.getElementById("overlays")),Object(C.createPortal)(Object(B.jsx)(F,{children:t}),document.getElementById("overlays"))]})},K=L.a.input(o||(o=Object(w.a)(["\n  border: 2px solid black;\n  border-radius: 5px;\n  padding: 10px 20px;\n  font-size: 16px;\n  font-weight: bold;\n  margin: 10px 20px;\n"]))),Q=L.a.button(s||(s=Object(w.a)(["\n  background-color: #ac0000;\n  color: white;\n  border: none;\n  border-radius: 10px;\n  padding: 8px 20px;\n  font-weight: bold;\n\n  &:hover {\n    cursor: pointer;\n    background-color: #c40000;\n  }\n"]))),X=function(e){var t=e.onClose,n=e.changeType,r=e.placeholder,a=e.btnText,c=Object(N.b)(),o=Object(S.useRef)(null);return Object(B.jsxs)(q,{onClose:t,children:[Object(B.jsx)(K,{ref:o,type:"text",placeholder:r}),Object(B.jsx)(Q,{onClick:function(){var e,r=(null===(e=o.current)||void 0===e?void 0:e.value)||"";""!==r.trim()&&("GROUP"===n&&c({type:A,groupName:r}),"NAME"===n&&c({type:z,newUsername:r}),t())},children:a})]})},Y=L.a.div(i||(i=Object(w.a)(["\n  background-color: #670d7e;\n  color: white;\n  width: 350px;\n  font-weight: bold;\n\n  & > h1 {\n    display: block;\n    margin: 30px 0 20px;\n    padding: 0 5px;\n    font-size: 20px;\n  }\n  & > button {\n    margin-bottom: 10px;\n  }\n"]))),Z=L.a.div(u||(u=Object(w.a)(["\n  border-top: 2px solid white;\n  margin-bottom: 0;\n  padding: 15px 5px;\n\n  h2 {\n    font-size: 16px;\n    margin: 0;\n  }\n  & > span {\n    font-size: 12px;\n    display: block;\n    margin: 6px 5px 0;\n  }\n"]))),$=L.a.ul(l||(l=Object(w.a)(["\n  padding: 0 0 0 15px;\n  margin: 10px 0;\n\n  li {\n    margin: 5px 0;\n    font-size: 15px;\n  }\n"]))),ee=L.a.button(h||(h=Object(w.a)(["\n  background-color: black;\n  color: white;\n  border: none;\n  border-radius: 20px;\n  margin-top: 10px;\n  padding: 6px 12px;\n  display: block;\n  font-weight: bold;\n\n  &:hover {\n    background-color: #202020;\n    cursor: pointer;\n  }\n"]))),te=function(){var e=D((function(e){return e.chat})),t=e.user,n=e.chatGroups,r=e.privateChats,a=e.onlineUsers,c=Object(N.b)(),o=Object(S.useState)(!1),s=Object(_.a)(o,2),i=s[0],u=s[1],l=Object(S.useState)(!1),h=Object(_.a)(l,2),p=h[0],b=h[1],d=Object(S.useState)(""),j=Object(_.a)(d,2),m=j[0],f=j[1],g=Object(S.useState)(""),O=Object(_.a)(g,2),x=O[0],v=O[1],C=function(e,t){c(function(e,t){return{type:R,chatType:e,chatName:t}}(e,t))},y=function(e){c(function(e){return{type:J,username:e}}(e))},w=function(){u((function(e){return!e}))},U=function(){b((function(e){return!e}))},k=n.filter((function(e){return e.name.toLowerCase().startsWith(m)})),E=r.filter((function(e){return(e.members[0]===t?e.members[1]:e.members[0]).startsWith(x)})),I=a.filter((function(e){return e!==t})),G=E.filter((function(e){return e.members.includes(t)}));return Object(B.jsxs)(Y,{children:[Object(B.jsxs)("h1",{children:["name: ",t]}),Object(B.jsx)(ee,{onClick:U,children:"change username"}),Object(B.jsx)(Z,{children:Object(B.jsx)("h2",{onClick:function(){return C("PUBLIC","")},children:"Public"})}),Object(B.jsxs)(Z,{children:[Object(B.jsx)("h2",{children:"Groups"}),Object(B.jsx)(V,{placeholder:"search group",onUserInput:function(e){f(e.toLowerCase())}}),k.length>0&&Object(B.jsx)($,{children:k.map((function(e){return Object(B.jsx)("li",{onClick:function(){return C("GROUPS",e.name)},children:e.name},e.name)}))}),0===k.length&&Object(B.jsx)("span",{children:"No groups found..."}),Object(B.jsx)(ee,{onClick:w,children:"+ create new group"})]}),Object(B.jsxs)(Z,{children:[Object(B.jsx)("h2",{children:"Private chats"}),Object(B.jsx)(V,{placeholder:"search private chat",onUserInput:function(e){v(e.toLowerCase())}}),G.length>0&&Object(B.jsx)($,{children:G.map((function(e){return Object(B.jsx)("li",{onClick:function(){return C("PRIVATE",e.members[0]!==t?e.members[0]:e.members[1])},children:e.members[0]!==t?e.members[0]:e.members[1]},e.members.toString())}))}),0===G.length&&Object(B.jsx)("span",{children:"No private conversations found"})]}),Object(B.jsxs)(Z,{children:[Object(B.jsx)("h2",{children:"Online users:"}),I.length>0&&Object(B.jsx)("ul",{children:I.map((function(e){return Object(B.jsx)("li",{onClick:function(){return y(e)},children:e},"id_".concat(e))}))}),0===I.length&&Object(B.jsx)("span",{children:"No other user online"})]}),i&&Object(B.jsx)(X,{changeType:"GROUP",onClose:w,placeholder:"Enter a new group name",btnText:"create group"}),p&&Object(B.jsx)(X,{changeType:"NAME",onClose:U,placeholder:"Enter a new username",btnText:"change username"})]})},ne=L.a.form(p||(p=Object(w.a)(["\n  background-color: #dddddd;\n  height: 20%;\n  text-align: center;\n  position: relative;\n"]))),re=L.a.textarea(b||(b=Object(w.a)(["\n  border: 2px solid black;\n  border-radius: 20px;\n  width: 80%;\n  margin-top: 26px;\n  padding: 10px;\n  resize: none;\n\n  &:focus {\n    outline: none;\n  }\n"]))),ae=L.a.button(d||(d=Object(w.a)(["\n  background-color: purple;\n  color: white;\n  border: none;\n  border-radius: 50px;\n  padding: 8px 35px;\n  font-weight: bold;\n  font-size: 15px;\n  position: absolute;\n  top: 88px;\n  right: 10%;\n  cursor: pointer;\n\n  &:hover {\n    background-color: #970097;\n  }\n"]))),ce=L.a.span(j||(j=Object(w.a)(["\n  position: absolute;\n  top: -30px;\n  left: 10px;\n  font-weight: bold;\n  z-index: 5;\n"]))),oe=function(){var e=D((function(e){return e.chat})),t=e.user,n=e.currentChatName,r=e.currentChat,a=Object(N.b)(),c=Object(S.useRef)(null);return Object(B.jsxs)(ne,{onSubmit:function(e){var n;e.preventDefault();var r=null===(n=c.current)||void 0===n?void 0:n.value;if(r&&0!==r.trim().length){var o,s=new Date;a((o={id:s.getTime()+t,author:t,date:s.toLocaleTimeString(),text:r},{type:G,message:o})),c.current.value=""}else alert("message must not be empty")},children:[Object(B.jsx)(re,{ref:c,placeholder:"Send a message"}),Object(B.jsx)(ae,{type:"submit",children:"Send"}),Object(B.jsxs)(ce,{children:[r,n?": ".concat(n):""]})]})},se=L.a.section(m||(m=Object(w.a)(["\n  border: 2px solid black;\n  height: 80%;\n  padding: 0 15px;\n  position: relative;\n  flex-grow: 1;\n  overflow: auto;\n\n  p {\n    margin: 0;\n    padding: 0;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-weight: bold;\n    font-size: 20px;\n    text-align: center;\n  }\n"]))),ie=L.a.li(f||(f=Object(w.a)(["\n  width: 100%;\n  margin: 13px 0 43px;\n  padding: 0 5px;\n  text-align: ",";\n  position: relative;\n\n  & > span {\n    padding: 7px 15px;\n    border: 1px solid black;\n    border-radius: 15px;\n    font-size: 14px;\n  }\n"])),(function(e){return e.author?"right":"left"})),ue=L.a.span(g||(g=Object(w.a)(["\n  display: block;\n  width: 100%;\n  width: auto;\n  margin-left: 5px;\n  font-size: 13px;\n  position: absolute;\n  top: 27px;\n  right: ",";\n"])),(function(e){return e.author?"5px":"auto"})),le=L.a.ul(O||(O=Object(w.a)(["\n  padding: 0;\n  margin: 0;\n  list-style-type: none;\n"]))),he=function(){var e=D((function(e){return e.chat.currentChatMessages})),t=D((function(e){return e.chat.user}));return Object(B.jsxs)(se,{children:[e.length>0&&Object(B.jsx)(le,{children:e.map((function(e){return Object(B.jsx)(ie,{author:e.author===t,children:Object(B.jsxs)("span",{children:[e.text,Object(B.jsxs)(ue,{author:e.author===t,children:[e.author===t?"you":e.author," -"," ",e.date]})]})},e.id)}))}),0===e.length&&Object(B.jsx)("p",{children:"No messages yet, start a conversation!"})]})},pe=L.a.div(x||(x=Object(w.a)(["\n  display: flex;\n  height: 100vh;\n"]))),be=L.a.div(v||(v=Object(w.a)(["\n  flex-grow: 1;\n"])));var de=function(){var e=Object(N.b)();return Object(S.useEffect)((function(){e({type:M});var t=function(t){var n,r,a=t.newValue;e((n=t.key,r=a?JSON.parse(a):[],{type:T,chatType:n,updatedChat:r}))},n=function(t){t.preventDefault(),e({type:P})};return window.addEventListener("storage",t),window.addEventListener("beforeunload",n),function(){window.removeEventListener("storage",t),window.removeEventListener("beforeunload",n)}}),[e]),Object(B.jsxs)(pe,{children:[Object(B.jsx)(te,{}),Object(B.jsxs)(be,{children:[Object(B.jsx)(he,{}),Object(B.jsx)(oe,{})]})]})},je=n(14),me=n(6),fe=n(2),ge=function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):[]},Oe=n(32),xe=sessionStorage.getItem("username"),ve=xe;xe||(ve=Oe.generate(),sessionStorage.setItem("username",ve));var Ce=ge(U),ye=ge(k),we=ge(E),Se=ge(I),Ne=[{name:"Group-1",chat:[]},{name:"Group-2",chat:[]},{name:"Group-3",chat:[]}];0===ye.length&&localStorage.setItem(k,JSON.stringify(Ne));var Ue={user:ve,currentChat:U,currentChatName:"",publicChat:Ce,chatGroups:ye.length>0?ye:Ne,privateChats:we,currentChatMessages:Ce,onlineUsers:Se},ke=Object(je.a)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;if(t.type===G){if(e.currentChat===U){var n=e.publicChat.concat(t.message);return localStorage.setItem(U,JSON.stringify(n)),Object(fe.a)(Object(fe.a)({},e),{},{publicChat:n,currentChatMessages:n})}if(e.currentChat===k){var r=e.chatGroups.findIndex((function(t){return t.name===e.currentChatName})),a=e.chatGroups[r],c=a.chat.concat(t.message),o=Object(fe.a)(Object(fe.a)({},a),{},{chat:c}),s=Object(me.a)(e.chatGroups);return s[r]=o,localStorage.setItem(k,JSON.stringify(s)),Object(fe.a)(Object(fe.a)({},e),{},{chatGroups:s,currentChatMessages:o.chat})}if(e.currentChat===E){var i=e.privateChats.findIndex((function(t){return t.members.includes(e.currentChatName)&&t.members.includes(e.user)})),u=e.privateChats[i],l=u.chat.concat(t.message),h=Object(fe.a)(Object(fe.a)({},u),{},{chat:l}),p=Object(me.a)(e.privateChats);return p[i]=h,localStorage.setItem(E,JSON.stringify(p)),Object(fe.a)(Object(fe.a)({},e),{},{privateChats:p,currentChatMessages:h.chat})}}if(t.type===T){var b=t.chatType===U?t.updatedChat:e.publicChat,d=t.chatType===k?t.updatedChat:e.chatGroups,j=t.chatType===E?t.updatedChat:e.privateChats,m=t.chatType===I?t.updatedChat:e.onlineUsers,f=!1,g=e.currentChatMessages;if(e.currentChat===U)g=b;else if(e.currentChat===k){var O=d.findIndex((function(t){return t.name===e.currentChatName}));g=d[O].chat}else if(e.currentChat===E){var x=j.findIndex((function(t){return t.members.includes(e.currentChatName)&&t.members.includes(e.user)}));-1!==x?g=j[x].chat:(f=!0,g=b)}return Object(fe.a)(Object(fe.a)({},e),{},{currentChat:f?U:e.currentChat,currentChatName:f?"":e.currentChatName,publicChat:b,chatGroups:d,privateChats:j,currentChatMessages:g,onlineUsers:m})}if(t.type===R){if(t.chatType===U)return Object(fe.a)(Object(fe.a)({},e),{},{currentChat:U,currentChatName:"",currentChatMessages:e.publicChat});if(t.chatType===k)return Object(fe.a)(Object(fe.a)({},e),{},{currentChat:k,currentChatName:t.chatName||"",currentChatMessages:e.chatGroups.find((function(e){return e.name===t.chatName})).chat});if(t.chatType===E){var v=e.privateChats.find((function(n){return n.members.includes(e.user)&&n.members.includes(t.chatName)}));return Object(fe.a)(Object(fe.a)({},e),{},{currentChat:E,currentChatName:t.chatName,currentChatMessages:v.chat})}}if(t.type===A){if(e.chatGroups.find((function(e){return e.name.toLowerCase()===t.groupName.toLowerCase()})))return alert("Group '".concat(t.groupName,"' already exists")),e;var C=e.chatGroups.concat({name:t.groupName,chat:[]});return localStorage.setItem(k,JSON.stringify(C)),Object(fe.a)(Object(fe.a)({},e),{},{chatGroups:C})}if(t.type===J){if(e.privateChats.find((function(n){return n.members.includes(t.username)&&n.members.includes(e.user)})))return e;var y={members:[e.user,t.username],chat:[]},w=e.privateChats.concat(y);return localStorage.setItem(E,JSON.stringify(w)),Object(fe.a)(Object(fe.a)({},e),{},{privateChats:w})}if(t.type===M){if(e.onlineUsers.includes(e.user))return e;var S=e.onlineUsers.concat(e.user);return localStorage.setItem(I,JSON.stringify(S)),Object(fe.a)(Object(fe.a)({},e),{},{onlineUsers:S})}if(t.type===P){var N=e.onlineUsers.filter((function(t){return t!==e.user}));return localStorage.setItem(I,JSON.stringify(N)),Object(fe.a)(Object(fe.a)({},e),{},{onlineUsers:N})}if(t.type===z){if(""===t.newUsername.trim())return e;for(var L=e.publicChat.map((function(n){return n.author!==e.user?n:Object(fe.a)(Object(fe.a)({},n),{},{author:t.newUsername})})),_=Object(me.a)(e.chatGroups),D=0;D<_.length;D++){for(var B=_[D],H=Object(me.a)(B.chat),V=0;V<H.length;V++)H[V].author===e.user&&(H[V]=Object(fe.a)(Object(fe.a)({},H[V]),{},{author:t.newUsername}));_[D]={name:_[D].name,chat:H}}for(var W=Object(me.a)(e.privateChats),F=0;F<W.length;F++){var q=W[F],K=Object(me.a)(q.members);K[0]===e.user?K[0]=t.newUsername:K[1]===e.user&&(K[1]=t.newUsername);for(var Q=Object(me.a)(q.chat),X=0;X<Q.length;X++)Q[X].author===e.user&&(Q[X]=Object(fe.a)(Object(fe.a)({},Q[X]),{},{author:t.newUsername}));W[F]={members:K,chat:Q}}var Y=e.onlineUsers.map((function(n){return n===e.user?t.newUsername:n}));return localStorage.setItem(U,JSON.stringify(L)),localStorage.setItem(k,JSON.stringify(_)),localStorage.setItem(E,JSON.stringify(W)),localStorage.setItem(I,JSON.stringify(Y)),sessionStorage.setItem("username",t.newUsername),alert("name changed succesfully"),{user:t.newUsername,publicChat:L,chatGroups:_,privateChats:W,onlineUsers:Y,currentChat:U,currentChatName:"",currentChatMessages:L}}return e}}),Ee=Object(je.b)(ke);y.a.render(Object(B.jsx)(N.a,{store:Ee,children:Object(B.jsx)(de,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.919e9d51.chunk.js.map